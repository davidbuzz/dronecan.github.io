<h1 id="application-level-conventions">Application-level conventions</h1>

<h2 id="id-distribution">ID distribution</h2>

<h3 id="message-type-id">Message type ID</h3>

<p>The valid range for <em>message type ID</em> is from 0 to 65535, inclusive (see <a href="/Specification/4._CAN_bus_transport_layer">CAN bus transport layer specification</a>).
The range is segmented as follows:</p>

<table>
  <thead>
    <tr>
      <th>ID range</th>
      <th>Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[0, 20000)</td>
      <td>Standard message types</td>
    </tr>
    <tr>
      <td>[20000, 21000)</td>
      <td>Vendor-specific message types</td>
    </tr>
    <tr>
      <td>[21000, 65536)</td>
      <td>Reserved for future use</td>
    </tr>
  </tbody>
</table>

<h3 id="service-type-id">Service type ID</h3>

<p>The valid range for <em>service type ID</em> is from 0 to 255, inclusive (see <a href="/Specification/4._CAN_bus_transport_layer">CAN bus transport layer specification</a>).
The range is segmented as follows:</p>

<table>
  <thead>
    <tr>
      <th>ID range</th>
      <th>Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>[0, 100)</td>
      <td>Standard service types</td>
    </tr>
    <tr>
      <td>[100, 200)</td>
      <td>Reserved for future use</td>
    </tr>
    <tr>
      <td>[200, 256)</td>
      <td>Vendor-specific service types</td>
    </tr>
  </tbody>
</table>

<h3 id="node-id">Node ID</h3>

<p>The valid range for <em>node ID</em> is from 1 to 127, inclusive (see <a href="/Specification/4._CAN_bus_transport_layer">CAN bus transport layer specification</a>).</p>

<p>The values 126 and 127 are reserved for debugging tools and should not be used for real nodes.</p>

<h2 id="coordinate-frames-and-rotation-representation">Coordinate frames and rotation representation</h2>

<p><a class="imagelink" href="/Specification/figures/rpy_angles_of_airplanes.png" data-lightbox="/Specification/figures/rpy_angles_of_airplanes.png" data-title="Coordinate frames">
<img src="/Specification/figures/rpy_angles_of_airplanes.png" class="thumbnail" style="" />
</a></p>

<p>DroneCAN follows the conventions that are widely accepted in various aerospace applications.</p>

<p>All systems are right handed. In relation to a body, the standard is as follows:</p>

<ul>
  <li>X forward</li>
  <li>Y right</li>
  <li>Z down</li>
</ul>

<p>In the case of cameras, the following convention should be preferred:</p>

<ul>
  <li>Z forward</li>
  <li>X right</li>
  <li>Y down</li>
</ul>

<p>For world frames, the <a href="https://en.wikipedia.org/wiki/North_east_down">North-East-Down (NED)</a> notation should be preferred.</p>

<p>The default rotation representation is quaternion. The coefficients are ordered as follows: X, Y, Z, W.</p>

<p>Angular velocities should be represented in fixed axis roll (about X), pitch (about Y), and yaw (about Z).</p>

<h2 id="matrix-representation">Matrix representation</h2>

<p>Matrices should be represented as flat arrays in row-major order.
There are some standard ways to represent an N-by-N square matrix in a one-dimensional array:</p>

<ul>
  <li>An empty array represents a zero matrix.</li>
  <li>An array of one element represents a scalar matrix.</li>
  <li>An array of N elements represents a diagonal matrix,
where each array member A<sub>i</sub> equals the matrix element M<sub>i,i</sub>.</li>
  <li>An array of ((1+N)*N)/2 elements represents a symmetric matrix,
where array members represent elements of the upper-right triangle arranged in row-major order.
For example, a 3-by-3 symmetric matrix can be represented as a flat array containing 6 matrix elements
in the following order:
[M<sub>1,1</sub>, M<sub>1,2</sub>, M<sub>1,3</sub>, M<sub>2,2</sub>, M<sub>2,3</sub>, M<sub>3,3</sub>].</li>
  <li>An array of size N<sup>2</sup> elements represents a full square matrix.</li>
</ul>

<h3 id="covariance-matrix">Covariance matrix</h3>

<p>A zero covariance matrix represents an unknown covariance.</p>

<p>Positive infinity in variance means that the associated value is undefined.
Alternatively, in some cases, the value itself can be set to NAN (not-a-number float constant) to indicate that
the parameter value is not defined.
Note though that it is recommended to avoid NAN and infinities whenever possible for portability reasons.</p>

<h2 id="engineering-units">Engineering units</h2>

<p>All units are <a href="http://en.wikipedia.org/wiki/International_System_of_Units">SI units</a>, unless explicitly noted otherwise.</p>

<p>The following field naming convention is used:</p>

<ul>
  <li>Fields that contain values not in SI units must be suffixed with the unit name, e.g.,
<code class="highlighter-rouge">battery_capacity_wh</code> (“wh” is for “Watt-hours” in this example).</li>
  <li>Fields that contain values in SI units are not suffixed, e.g., <code class="highlighter-rouge">voltage</code> (implying that the units are Volts).</li>
</ul>

<p>If an application designer chooses to deviate, such decision should be properly documented.</p>
